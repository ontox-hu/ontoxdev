[
  {
    "path": "posts/project-predictions-and-pmids/",
    "title": "Sysrev predictions and pmids",
    "description": "project-predictions-and-pmids",
    "author": [
      {
        "name": "Thomas Luechtefeld",
        "url": {}
      }
    ],
    "date": "2022-02-28",
    "categories": [],
    "contents": "\nThe sysrev projects Jonas-van-Ertvelde/AOP updating vub steatosisand jian-jiang/AOP updating vub steatosis both import articles from pubmed.\nHow to link sysrev article ids to pubmed ids?\nArticles imported to Sysrev from pubmed track pmids in `external_id`:\n\n\naop = rbind(\n  rsr::get_articles(103067),\n  rsr::get_articles(113583))\n\naop |> \n  select(project_id,aid,datasource_name,external_id) |> \n  print(n=2)\n\n\n# A tibble: 19,050 × 4\n  project_id      aid datasource_name external_id   \n       <int>    <int> <chr>           <chr>         \n1     103067 13591692 pubmed          \"\\\"24151358\\\"\"\n2     103067 13591700 pubmed          \"\\\"26910619\\\"\"\n# … with 19,048 more rows\n\nThe first article can be found at sysrev.com/p/103067/article/13591692 and also at https://pubmed.ncbi.nlm.nih.gov/24151358/.\nFiltering with machine learning\nBoth of these projects have predictions generated by Sysrev machine learning.\n\n\n# Warning, very large query and takes 5-6 minutes to run\naop.pred.raw  <- rbind(\n  rsr::get_predictions(103067),\n  rsr::get_predictions(113583))\n\n# get the most recent predictions\naop.pred = aop.pred.raw |> \n  group_by(project_id) |> \n  filter(predict_run_id==max(predict_run_id)) \n\naop.pred |> \n  select(project_id,predict_run_id,lid,value,probability) |> \n  print(n=2)\n\n\n# A tibble: 413,860 × 5\n# Groups:   project_id [2]\n  project_id predict_run_id lid                      value probability\n       <int>          <int> <chr>                    <chr>       <dbl>\n1     103067          27277 412b8a66-7b92-4554-b543… Dire…       0.502\n2     103067          27277 412b8a66-7b92-4554-b543… Dire…       0.511\n# … with 413,858 more rows\n\nFiltering with predict_run_id==max(predict_run_id) in each project gives us the most recent predictions in each project. Now we can join with the labels defined in each project:\n\n\naop.lbl <- rbind(\n  rsr::get_labels(103067),\n  rsr::get_labels(113583)) |> \n  select(lid,short_label)\n\n# TODO, this vignette is incomplete come back and finish it\naop.pred |> \n  inner_join(aop.lbl,by=\"lid\") |> \n  filter(short_label==\"Include\") |> \n  select(project_id,aid,short_label,value,probability)\n\n\n# A tibble: 38,100 × 5\n# Groups:   project_id [2]\n   project_id      aid short_label value probability\n        <int>    <int> <chr>       <chr>       <dbl>\n 1     103067 13592066 Include     TRUE        0.391\n 2     103067 13592227 Include     TRUE        0.512\n 3     103067 13591910 Include     TRUE        0.431\n 4     103067 13592023 Include     TRUE        0.351\n 5     103067 13592090 Include     TRUE        0.575\n 6     103067 13592080 Include     TRUE        0.448\n 7     103067 13592069 Include     TRUE        0.428\n 8     103067 13592079 Include     TRUE        0.536\n 9     103067 13592077 Include     TRUE        0.544\n10     103067 13592070 Include     TRUE        0.594\n# … with 38,090 more rows\n\n\n\n\n",
    "preview": {},
    "last_modified": "2022-03-12T16:01:50-05:00",
    "input_file": {}
  }
]
